% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/iiasa_gtap.R
\name{iiasa_gtap}
\alias{iiasa_gtap}
\title{Process and Aggregate IIASA Data for GTAP SSP Integration}
\usage{
iiasa_gtap(
  outFile = NULL,
  group_cols = c("model", "scenario", "reg_iso3", "variable", "unit")
)
}
\arguments{
\item{outFile}{Character. Optional path to save the final dataset as a CSV file. If \code{NULL}, the
file is not saved. Default is \code{NULL}.}

\item{group_cols}{Character vector. Columns to group by during aggregation.
Default is \code{c("model", "scenario", "reg_gtap_code", "variable", "unit")}.}
}
\value{
A processed data frame containing the summarized and processed IIASA database.
}
\description{
This function executes the routine for processing and aggregating IIASA data for GTAP SSP integration.
The routine includes data aggregation, interpolation (spline and beers methods), column expansion,
filtering, and growth rate calculation. Optionally, the final dataset can be saved as a CSV file.
}
\details{
\strong{Steps in the Routine}:
\itemize{
\item \strong{Step 1: Data Aggregation}:
Aggregates the IIASA raw data using the \code{\link[=aggData]{aggData()}} function, which allows for
regional mappings based on \code{aggTxtFile}. The aggregation groups the data by columns specified
in \code{group_cols} and combines regional data accordingly.

\item \strong{Step 2: Spline Interpolation}:
Applies the \code{\link[=interpolate_spline]{interpolate_spline()}} function to interpolate missing values in the
\code{value} column for the specified models (\code{"IIASA GDP 2023"}, \code{"OECD ENV-Growth 2023"}).
The cubic spline method creates a smooth curve that passes through the available data points,
ensuring continuity in derivatives and producing realistic interpolations.

\item \strong{Step 3: Beers Interpolation}:
Applies the \code{\link[=interpolate_beers]{interpolate_beers()}} function to interpolate missing population data
(\code{model = "IIASA-WiC POP 2023"}) using Beers interpolation. This method is specifically
designed for demographic data, providing age-structured estimates that align with population
distribution and totals. It preserves consistency between age groups while interpolating.

\item \strong{Step 4: Combine Outputs}:
Combines the results of the spline and beers interpolations.
This step stacks the interpolated data vertically to produce a unified dataset.

\item \strong{Step 5: Expand Variables}:
Splits the \code{variable} column into multiple columns (e.g., \code{variable}, \code{gender}, \code{cohort},
and \code{education_level}). This expansion helps isolate
specific attributes encoded in the \code{variable} column.

\item \strong{Step 6: Filter Data}:
Filters rows based on several conditions:
\itemize{
\item Removes total rows (\code{education_level} is \code{NA}) unless the scenario is
\code{"Historical Reference"} or the cohort is among \verb{Age 0-4}, \verb{Age 5-9}, or \verb{Age 10-14}.
}

\item \strong{Step 7: Calculate Growth Rates}:
Uses \code{\link[=growth_rate]{growth_rate()}} to calculate annual growth rates for the \code{value} column.
Growth rates are computed as percentage changes between consecutive years within each group
specified in \code{group_cols}.

\item \strong{Step 8: Save to File (Optional)}:
If \code{outFile} is provided, saves the final processed dataset to a .HAR or .CSV file
}
}
\examples{
\dontrun{
# Run the routine and save output to a HAR
final_data <- gtapssp::iiasa_gtap(
  outFile = "path/to/output.har"
)

# Run the routine and save output to a CSV
final_data <- gtapssp::iiasa_gtap(
  outFile = "path/to/output.csv"
)

# Run the routine without saving
final_data <- gtapssp::iiasa_gtap()
}

}
\seealso{
\link[gtapssp]{aggData},
\link[gtapssp]{interpolate_spline},
\link[gtapssp]{interpolate_beers},
\link[gtapssp]{growth_rate}
}
